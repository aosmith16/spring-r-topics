<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>How to reprex</title>
    <meta charset="utf-8" />
    <script src="week09_reprex_files/header-attrs/header-attrs.js"></script>
    <meta name="github-repo" content="aosmith16/spring-r-topics"/>
    <meta name="twitter:title" content="How to reprex"/>
    <meta name="twitter:description" content="Reproducible examples in R + GitHub issue etiquette"/>
    <meta name="twitter:url" content="https://aosmith16.github.io/spring-r-topics/slides/week09_reprex.html"/>
    <meta name="twitter:image:src" content="https://raw.githubusercontent.com/aosmith16/spring-r-topics/main/slides/week09-share-card.png"/>
    <meta name="twitter:image:alt" content="Slides for how to reprex Working sessions class spring 2021"/>
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:creator" content="@aosmith16"/>
    <meta name="twitter:site" content="@aosmith16"/>
    <meta property="og:title" content="How to reprex"/>
    <meta property="og:description" content="Reproducible examples in R + GitHub issue etiquette"/>
    <meta property="og:url" content="https://aosmith16.github.io/spring-r-topics/slides/week09_reprex.html"/>
    <meta property="og:image" content="https://raw.githubusercontent.com/aosmith16/spring-r-topics/main/slides/week09-share-card.png"/>
    <meta property="og:image:alt" content="Slides for how to reprex Working sessions class spring 2021"/>
    <meta property="og:type" content="website"/>
    <meta property="og:locale" content="en_US"/>
    <meta property="article:author" content="Ariel Muldoon"/>
    <script src="week09_reprex_files/fabric/fabric.min.js"></script>
    <link href="week09_reprex_files/xaringanExtra-scribble/scribble.css" rel="stylesheet" />
    <script src="week09_reprex_files/xaringanExtra-scribble/scribble.js"></script>
    <script>document.addEventListener('DOMContentLoaded', function() { window.xeScribble = new Scribble({"pen_color":["#FF0000"],"pen_size":3,"eraser_size":30}) })</script>
    <script src="week09_reprex_files/clipboard/clipboard.min.js"></script>
    <link href="week09_reprex_files/xaringanExtra-clipboard/xaringanExtra-clipboard.css" rel="stylesheet" />
    <script src="week09_reprex_files/xaringanExtra-clipboard/xaringanExtra-clipboard.js"></script>
    <script>window.xaringanExtraClipboard(null, {"button":"Copy Code","success":"Copied!","error":"Press Ctrl+C to Copy"})</script>
    <link href="week09_reprex_files/tile-view/tile-view.css" rel="stylesheet" />
    <script src="week09_reprex_files/tile-view/tile-view.js"></script>
    <script src="week09_reprex_files/js-cookie/js.cookie.js"></script>
    <script src="week09_reprex_files/peerjs/peerjs.min.js"></script>
    <script src="week09_reprex_files/tiny.toast/toast.min.js"></script>
    <link href="week09_reprex_files/xaringanExtra-broadcast/broadcast.css" rel="stylesheet" />
    <script src="week09_reprex_files/xaringanExtra-broadcast/broadcast.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
    <link rel="stylesheet" href="wrap.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
















class: center, middle, title-slide

# How to reprex
## *Making reproducible examples in R*

&lt;img src="figs/reprex.png" title="Logo for package reprex" alt="Logo for package reprex" width="15%" /&gt;

### Ariel Muldoon
### May 25, 2021

---

class: with-logo logo-reprex

## Today's Goal

Overall  
- **Learn how to make reproducible examples in R**   

--

We will  

-     Discuss the components of a *minimal* reproducible example based on a real example
-     Learn to use package **reprex** to help make code and output that you can paste into GitHub issues or help forums       
-     Add data to a reprex with package **datapasta**    

---

class: with-logo logo-reprex

## Resources

- [Reprex do's and don'ts](https://reprex.tidyverse.org/articles/reprex-dos-and-donts.html) from the **reprex** website  
- Sharla Gelfand's "make a reprex... please" [slides](https://make-a-reprex-please.netlify.app/#1) and [recording](https://t.co/860RTqMvjy)   
- [How to Datapasta](https://milesmcbain.github.io/datapasta/articles/how-to-datapasta.html)  

.center[
&lt;img src="figs/week09_files/datapasta.png" title="Logo for package datapasta" alt="Logo for package datapasta" width="25%" /&gt;
]

---

## What is a reprex?

The term *reprex* stands for **repr**oducible **ex**ample.

If you ever ask for help in R on a forum or want to report an issue on a GitHub repository you will be asked for example code that others can run to reproduce whatever problem you are having.

--

&lt;br/&gt;&lt;br/&gt;
There are several nice overviews of how to make a reproducible example that are worth reading.

[RStudio Community guide](https://community.rstudio.com/t/faq-how-to-do-a-minimal-reproducible-example-reprex-for-beginners/23061)  
[Stack Overflow canonical thread](https://stackoverflow.com/questions/5963269/how-to-make-a-great-r-reproducible-example)  
[Tidyverse help guide](https://www.tidyverse.org/help/)

---

## What is in a reprex?

&lt;br/&gt;
A reprex should include:    
    
&gt; - A minimal dataset, necessary to reproduce the issue  

&gt; - The minimal runnable code necessary to reproduce the issue, which can be run
on the given dataset, and including the necessary information on the used packages.  

*From the RStudio Community guide*

---

## What is in a reprex?

&lt;br/&gt;
A reprex should include:    
    
&gt; - a minimal dataset, necessary to demonstrate the problem   

&gt; - the minimal runnable code necessary to reproduce the error, which can be run on the given dataset  
&gt; - all necessary information on the used packages, the R version, and the OS it is run on.  

&gt; - in the case of random processes, a seed (set by set.seed()) for reproducibility  

*From the Stack Overflow thread on reproducible examples*

--

&lt;br/&gt;
Note the consistent use of the word **minimal**.

???

We'll be talking about minimal later.

---

## Why should I reprex?

Making a minimal, reproducible example can take time. It can be easy to convince yourself to skip the process and "just get the help I need".

But the time is ultimately worth spending. üíµ

--


&gt; - 80% of the time creating an excellent reprex reveals the source of your problem. It‚Äôs amazing how often the process of writing up a self-contained and minimal example allows you to answer your own question.  

&gt; - The other 20% of time you will have captured the essence of your problem in a way that is easy for others to play with. This substantially improves your chances of getting help!

*From the tidyverse help guide*

???

A lot of times you can solve your own problem while working towards a minimal, reproducible example.

---

## Why should I reprex?

.center[
&lt;img src="figs/week09_files/reprex_art.png" title="Artwork by Allison Horst showing cartoon monsters enjoying success when they provided  a reproducible example, helping others help them solve their problem" alt="Artwork by Allison Horst showing cartoon monsters enjoying success when they provided  a reproducible example, helping others help them solve their problem" width="70%" /&gt;
Artwork by @allisonhorst
]

???

It helps people help you!  It also makes make it much more likely you will get a positive response.

---

## Why should I reprex?

&lt;blockquote class="twitter-tweet tw-align-center" data-lang="en"&gt;&lt;p lang="en" dir="ltr"&gt;Reproducible examples&lt;/p&gt;&amp;mdash; Sharla Gelfand (@sharlagelfand) &lt;a href="https://twitter.com/sharlagelfand/status/1365665149063987201"&gt;Tweet February 27, 2021&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src="//platform.twitter.com/widgets.js" charset="utf-8"&gt;&lt;/script&gt;

???

And you will be asked for one! I included this tweet to focus on the picture of the shared slide.

---

## The plan for today

- I will introduce an R coding scenario that I need your help solving
- We'll go through my attempts to provide a reproducible example, with you running the code I provide to see the output
- We'll discuss how I can improve things so my code meets the definition of a minimal reproducible example
- Finally, we'll practice using package **reprex** to get code and output ready to paste into a forum and then discuss more features of the package  

--

&lt;br/&gt;
This gets us ready for next week when we'll
- Talk about GitHub issues and issue etiquette  
- Practice making an issue, writing text and pasting **reprex** code

???

GitHub issues was originally in this same slide deck but I decided it'd be better to use the time in a separate working session.

---

class: center, middle, inverse

# &lt;font style="font-family: cursive; font-style:italic"&gt;Let's get started!&lt;/font&gt;

---

## "I need help" take 1 üé¨

**Me:** "I'm having a problem with my **ggplot2** code. My points dodge but my error bars don't. Help! Here is my code."

**You:** Copy and paste the code below into your R Console and run.  What happens?

.smaller[

```r
ggplot(data = mydata, aes(x = over_species, y = est1)) +
    geom_point(aes(color = spp), 
               position = position_dodge(width = .5),
               size = 2) +
    geom_errorbar(aes(ymin = lo1, ymax = hi1),
                  position = position_dodge(width = .5),
                  width = .2) +
    scale_color_manual(values = c("#1c5253", "#F4790B"),
                       labels = c("Douglas-fir", "Red alder")) +
    labs(color = "Species",
         x = "Overstory",
         y = "Estimate") +
    theme_minimal() +
    theme(panel.grid.major.x = element_blank(),
          panel.grid.minor.y = element_blank(),
          legend.direction = "horizontal",
          legend.position = "bottom",
          legend.box.spacing = unit(0, "pt"),
          plot.margin = margin(b = 0))
```
]

---

## "I need help" take 1 üé¨

When the error message indicates a function can't be found, most often the package wasn't loaded. 

That's the case here. I didn't provide the packages I'm using in my example code.


```
## Error in ggplot(data = mydata, aes(x = over_species, y = est1)) : 
##   could not find function "ggplot"
```

--

&lt;br/&gt;&lt;br/&gt;
You might now be thinking something along the lines of, "Well, geez, people can easily guess what package I'm using."

When asking for help you want to make it as easy as possible for people to help you. Providing all code, including packages, means they don't have to try to guess which packages you are using.

???

This is the classic "help me help you" slide

---

## "I need help" take 1 üé¨

Going back to the info in the guides for reproducible examples, I should provide:

&gt; ...runnable code necessary to reproduce the issue, which can be run
on the given dataset, and including the necessary information on the used packages.

&lt;br/&gt;
OK, I didn't give code for the data or packages in my first attempt. Let me try again.

---

## "I need help" take 2 üé¨

**Me:** "Oh, you need my packages and dataset? Here you go."

.tiny[

```r
library(covr)
library(car)
library(nlme)
library(ggbiplot)
library(devtools)
library(ggplot2)
library(dplyr)
library(emmeans)

setwd("C:/Users/USER/Documents/MyProject")

data = read.csv("all_project_data.csv")
mydata = read.csv("all_results.csv")

table = data %&gt;%
    group_by(over_species, spp) %&gt;%
    summarize(mean = mean(variable),
              sd = sd(variable))

mod = lm(variable ~ over_species*spp, data = data)
summary(mod) # Save these results!

ggplot(data = mydata, aes(x = over_species, y = est1)) +
    geom_point(aes(color = spp), 
               position = position_dodge(width = .5),
               size = 2) +
    geom_errorbar(aes(ymin = lo1, ymax = hi1),
                  position = position_dodge(width = .5),
                  width = .2) +
    scale_color_manual(values = c("#1c5253", "#F4790B"),
                       labels = c("Douglas-fir", "Red alder")) +
    labs(color = "Species",
         x = "Overstory",
         y = "Estimate") +
    theme_minimal() +
    theme(panel.grid.major.x = element_blank(),
          panel.grid.minor.y = element_blank(),
          legend.direction = "horizontal",
          legend.position = "bottom",
          legend.box.spacing = unit(0, "pt"),
          plot.margin = margin(b = 0))
```
]

---

## "I need help" take 2 üé¨

**You:** Are likely feeling overwhelmed right now because I just gave you a bunch of code that isn't relevant to the problem. üòÜ

--

&lt;br/&gt;
I asked you earlier to note the use of the word **minimal** used over and over in all the descriptions of a reproducible example.

Let's talk more about that now.

---

## *Minimal* code

When asked to provide the package and dataset I made a reasonable attempt to do so. However, I went way too far the other way and provided way more than I needed to.

--

&lt;br/&gt;
When providing an example, give absolute minimum amount of code that can reproduce the problem. No extra packages, no extra data manipulation steps, etc. 

&lt;br/&gt;
Give the final dataset; the person helping you should not have to run a bunch of code to create the dataset. (*More on datasets coming up.*)

???

Don't make your potential helpers run all the code to create a dataset in a bunch of data manipulation steps. Provide them the final dataset.

---

## *Minimal* code.

Even when I get rid of the extraneous packages and data manipulation steps my code isn't minimal.

All tweaks to the plot appearance, such as those highlighted below, are not related to the problem I am having. These should be removed.

.tiny[

```r
library(ggplot2)

setwd("C:/Users/USER/Documents/MyProject")

mydata = read.csv("all_results.csv")

ggplot(data = mydata, aes(x = over_species, y = est1)) +
    geom_point(aes(color = spp), 
               position = position_dodge(width = .5),
               size = 2) +
    geom_errorbar(aes(ymin = lo1, ymax = hi1),
                  position = position_dodge(width = .5),
                  width = .2) +
*   scale_color_manual(values = c("#1c5253", "#F4790B"),
*                      labels = c("Douglas-fir", "Red alder")) +
*   labs(color = "Species",
*        x = "Overstory",
*        y = "Estimate") +
*   theme_minimal() +
*   theme(panel.grid.major.x = element_blank(),
*         panel.grid.minor.y = element_blank(),
*         legend.direction = "horizontal",
*         legend.position = "bottom",
*         legend.box.spacing = unit(0, "pt"),
*         plot.margin = margin(b = 0))
```
]

---

## "I need help" take 3 üé¨

Me: "OK, I got things down to just the code that produces the problem. Here you go!"

You: Copy and paste the code into your R Console and run.  What happens now?


```r
library(ggplot2)

setwd("C:/Users/USER/Documents/MyProject")

mydata = read.csv("all_results.csv")

ggplot(data = mydata, aes(x = over_species, y = est1)) +
    geom_point(aes(color = spp), 
               position = position_dodge(width = .5),
               size = 2) +
    geom_errorbar(aes(ymin = lo1, ymax = hi1),
                  position = position_dodge(width = .5),
                  width = .2)
```

---

## "I need help" take 3 üé¨

Now that the packages are loaded, the errors are related to the dataset.


```
## Error in setwd("C:/Users/USER/Documents/MyProject") : 
##   cannot change working directory
```

```
## Error in file(file, "rt") : cannot open the connection
## In addition: Warning message:
## In file(file, "rt") :
##   cannot open file),'all_project_data.csv': No such file or directory
```

---

## The problem of setwd()

We're going to talk more about how to provide datasets, but first let's talk about my use of `setwd()` while asking someone who isn't on my personal computer to run my code.

--

An excerpt from ["Reprex do's and don'ts"](https://reprex.tidyverse.org/articles/reprex-dos-and-donts.html) captures the problem: 

&gt; **Pack it in, pack it out, and don‚Äôt take liberties with other people‚Äôs computers.** You are asking people to run this code!

&gt; - Don‚Äôt start with `rm(list = ls())`. It is anti-social to clobber other people‚Äôs workspaces.

&gt; - Don‚Äôt start with `setwd("C:\Users\jenny\path\that\only\I\have")`, because it won‚Äôt work on anyone else‚Äôs computer.

--

&lt;br/&gt;
Your goal is to make it easy for someone else to run your code, and `setwd()` doesn't do that.

If you reguarly use `setwd()` in your work, consider switching to [Project-oriented workflows](https://www.tidyverse.org/blog/2017/12/workflow-vs-script/). 

???

Can add asides here about issues of `setwd()` for your future self or your self using a different computer.

---

## Providing a dataset

The thing I've seen people struggle with the most is in providing a dataset to reproduce the problem.

This is one place where making a reproducible example can get time-consuming.

--

&lt;br/&gt;
The three most common ways to provide a dataset in a reproducible example:
1. Create a fake dataset.
2. Use a built-in dataset like `mtcars` or `iris`.
3. Provide some portion of your real dataset using **datapasta**.

---

### Create a fake dataset

If your data are proprietary or your dataset is too large to provide any other way, consider making fake dataset. 

With practice, this is often one of the easiest ways to provide a *minimal* dataset.

???

Many problems can be reproduced without working with your entire real dataset

---

### Create a fake dataset

.pull-left[
Here is an example of making a small dataset that matches the features and variables in my real dataset. 

Since my problem is with dodging it turns out I only need a single `x` variable group to reproduce the problem. My example ends up having two rows of data.
]

.pull-right[
.smaller[

```r
mydata = data.frame(over_species = c("ACMA", "ACMA"),
                    spp = c("DF", "RA"),
                    est1 = c(1, 2),
                    lo1 = c(1, 2) - 2,
                    hi1 = c(1, 2) + 2)
mydata
```

```
##   over_species spp est1 lo1 hi1
## 1         ACMA  DF    1  -1   3
## 2         ACMA  RA    2   0   4
```
]
]

.footnote[See other ways to make fake data, such as with functions from package **tibble**, in this [RStudio Community thread](https://community.rstudio.com/t/best-practices-how-to-prepare-your-own-data-for-use-in-a-reprex-if-you-can-t-or-don-t-know-how-to-reproduce-a-problem-with-a-built-in-dataset/5346/8).]

---

### Create a fake dataset

The beauty of making a fake dataset like this is that you can include the code for creating it along with the rest of your code.

Copy the code and try running it in your R Console; you will finally get a plot as output!


```r
library(ggplot2)

mydata = data.frame(over_species = rep("ACMA", times = 2),
                        spp = c("DF", "RA"),
                        est1 = c(1, 2),
                        lo1 = c(1, 2) - 2,
                        hi1 = c(1, 2) + 2)

ggplot(data = mydata, aes(x = over_species, y = est1)) +
    geom_point(aes(color = spp), 
               position = position_dodge(width = .5),
               size = 2) +
    geom_errorbar(aes(ymin = lo1, ymax = hi1),
                  position = position_dodge(width = .5),
                  width = .2)
```

**Note:** If your example contains randomly generated numbers, be sure to provide a seed with `set.seed()`.

---

### Use a built-in dataset

Editing your code to work with one of the datasets built in to R is another good option and saves you the trouble of making a dataset. 

--

&lt;br/&gt;
Commonly used datasets include `mtcars` üöó and `iris` üåº, but there are a ton of other ones.  Run `data()` in your R Console to see all available datasets that come with R.

You can also opt to use datasets that come with add-on packages, but remember that requires your potential helpers to have that package.

---

### Use a built-in dataset

Using a built-in dataset means I have to change my code a little.  

Here's how I took `mtcars` and rewrote my code to reproduce the problem. I chose just two rows of the dataset that had the same value of `gear` but different values of `vs`.

Copy the code and run it in your R Console to see what this looks like.


```r
library(ggplot2)

ggplot(data = mtcars[2:3,], aes(x = factor(gear), y = mpg)) +
    geom_point(aes(color = factor(vs)), 
               position = position_dodge(width = .5),
               size = 2) +
    geom_errorbar(aes(ymin = mpg - 1, ymax = mpg + 1),
                  position = position_dodge(width = .5),
                  width = .2)
```

???

Also note how I didn't need actual values in the dataset for making error bars.

---

class: with-logo logo-pasta

## Using **datapasta** to provide data

If you want to provide your actual dataset you can use helper functions from package **datapasta**. 

There are other options for doing this, such as function `dput()`, but **datapasta** puts the result in a very readable format.

&lt;br/&gt;
We'll be using `datapasta::dpasta()` to briefly explore how this works.

There is much more you can do with **datapasta** then how we are using it here. Check out [How to Datapasta](https://milesmcbain.github.io/datapasta/articles/how-to-datapasta.html) for neat examples on copying and pasting data from online sources, etc.

---

class: with-logo logo-pasta

## Using **datapasta** to provide data

Run the code below in your R Console to see how `dpasta()` turns the first few rows and columns of `mtcars` into an easily copy-and-pasteable format. 


```r
datapasta::dpasta(mtcars[1:6, 1:3])
```


```r
data.frame(
   row.names = c("Mazda RX4","Mazda RX4 Wag","Datsun 710",
                 "Hornet 4 Drive","Hornet Sportabout","Valiant"),
         mpg = c(21, 21, 22.8, 21.4, 18.7, 18.1),
         cyl = c(6, 6, 4, 6, 8, 6),
        disp = c(160, 160, 108, 258, 360, 225)
)
```

**Note:** I found slight alignment issue with the output format from `dpasta()`, as shown above. When formatting the output `Ctrl + I` (MacOS `Cmd + I`) will fix that right up. üëç

---

class: with-logo logo-pasta

## Using **datapasta** to provide data

This is exactly the approach I want in order to include my actual dataset with my code.

Here's what my actual dataset looks like:


|over_species |spp | est1|  lo1|  hi1| est2|  lo2|  hi2| var1| var2|
|:------------|:---|----:|----:|----:|----:|----:|----:|----:|----:|
|ACMA         |DF  | 11.8|  9.8| 13.8| 11.5|  6.5| 16.5| -1.0| -0.7|
|ACMA         |RA  |  7.4|  5.4|  9.4| 26.6| 21.6| 31.6|  0.1|  1.7|
|ALRU         |DF  |  9.5|  7.5| 11.5| 27.5| 22.5| 32.5|  1.0|  0.7|
|ALRU         |RA  |  7.3|  5.3|  9.3| 12.8|  7.8| 17.8|  0.6| -1.7|
|PSME         |DF  | 13.6| 11.6| 15.6| 16.4| 11.4| 21.4|  1.8|  0.6|
|PSME         |RA  |  8.1|  6.1| 10.1| 21.8| 16.8| 26.8|  0.1|  0.5|

Take note of all the extra columns. In keeping with making things minimal, I'll remove any column that isn't directly relevant to the problem prior to using `dpasta()`.

---

## "I need help" take 4 üé¨

**Me:** "I'm having a problem with my **ggplot2** code. My points dodge but my error bars don't. Help! Here is a minimal reproducible example."

**You:** Since you can now copy and paste the code into your R Console and immediately get it to run, you can jump right to helping me find solutions. üéâ

.smaller[

```r
library(ggplot2)

mydata = data.frame(
    stringsAsFactors = FALSE,
    over_species = c("ACMA", "ACMA", "ALRU", "ALRU", "PSME", "PSME"),
    spp = c("DF", "RA", "DF", "RA", "DF", "RA"),
    est1 = c(11.8, 7.4, 9.5, 7.3, 13.6, 8.1),
    lo1 = c(9.8, 5.4, 7.5, 5.3, 11.6, 6.1),
    hi1 = c(13.8, 9.4, 11.5, 9.3, 15.6, 10.1)
)

ggplot(data = mydata, aes(x = over_species, y = est1)) +
    geom_point(aes(color = spp), 
               position = position_dodge(width = .5),
               size = 2) +
    geom_errorbar(aes(ymin = lo1, ymax = hi1),
                  position = position_dodge(width = .5),
                  width = .2)
```
]

???

I did re-format the output from dpasta() with Ctrl + I

---

class: with-logo logo-reprex

## The reprex package

The goal of this package is to 
&gt;Render bits of R code for sharing, e.g., on GitHub or StackOverflow

--

&lt;br/&gt;
The package takes a chunk of your code and runs it, returning both the code and the code output on your clipboard. Paste the result into your question on Stack Overflow or when reporting a potential issue on GitHub.

Now someone can copy your code and run it but, importantly, they can also see what the output looks like without having to run any code at all. 

---

class: with-logo logo-reprex

## The reprex package

One way simple way to use the **reprex** package is to copy the code from your minimal reproducible example onto your clipboard.

Here's my working example to copy again:

.smaller[

```r
library(ggplot2)

mydata = data.frame(
    stringsAsFactors = FALSE,
    over_species = c("ACMA", "ACMA", "ALRU", "ALRU", "PSME", "PSME"),
    spp = c("DF", "RA", "DF", "RA", "DF", "RA"),
    est1 = c(11.8, 7.4, 9.5, 7.3, 13.6, 8.1),
    lo1 = c(9.8, 5.4, 7.5, 5.3, 11.6, 6.1),
    hi1 = c(13.8, 9.4, 11.5, 9.3, 15.6, 10.1)
)

ggplot(data = mydata, aes(x = over_species, y = est1)) +
    geom_point(aes(color = spp), 
               position = position_dodge(width = .5),
               size = 2) +
    geom_errorbar(aes(ymin = lo1, ymax = hi1),
                  position = position_dodge(width = .5),
                  width = .2)
```
]

---

class: with-logo logo-reprex

## The reprex package

.pull-left[
Once you have code copied to your clipboard, run `reprex::reprex()` in your R Console.

&lt;br/&gt;
All code and output will be copied to your clipboard and a rendered HTML preview will show in your `Viewer` Pane.

&lt;br/&gt;
The copied result is ready to be pasted on GitHub or Stack Overflow and will render correctly.
]

.pull-right[
&lt;img src="figs/week09_files/reprex1.png" title="Screen shot showing the Viewer Pane after copying my reproducible example code and then running reprex::reprex() in my R Console" alt="Screen shot showing the Viewer Pane after copying my reproducible example code and then running reprex::reprex() in my R Console" width="100%" /&gt;
]

???

See the example Viewer pane on the right throughout this section

---

class: with-logo logo-reprex

## The reprex package

Instead of using the copying + `reprex()` technique you can alternatively wrap your reproducible example code within curly braces inside `reprex::reprex()`. Run the following:

.smaller[

```r
reprex::reprex({
    library(ggplot2)
    
    mydata = data.frame(
        stringsAsFactors = FALSE,
        over_species = c("ACMA", "ACMA", "ALRU", "ALRU", "PSME", "PSME"),
        spp = c("DF", "RA", "DF", "RA", "DF", "RA"),
        est1 = c(11.8, 7.4, 9.5, 7.3, 13.6, 8.1),
        lo1 = c(9.8, 5.4, 7.5, 5.3, 11.6, 6.1),
        hi1 = c(13.8, 9.4, 11.5, 9.3, 15.6, 10.1)
    )
    
    ggplot(data = mydata, aes(x = over_species, y = est1)) +
        geom_point(aes(color = spp), 
                   position = position_dodge(width = .5),
                   size = 2) +
        geom_errorbar(aes(ymin = lo1, ymax = hi1),
                      position = position_dodge(width = .5),
                      width = .2)
})
```
]

---

class: with-logo logo-reprex

## The reprex package

Let's do another example.

.pull-left[
Here's a classic **dplyr** before **plyr** problem with `summarise()`.


```r
reprex::reprex({
    library(dplyr)
    library(plyr)
    
    mtcars %&gt;%
        group_by(cyl) %&gt;%
        summarise(mpg = mean(mpg))
})
```

Note the many, many messages from the packages.
]

.pull-right[
&lt;img src="figs/week09_files/reprex_dplyr.png" title="Screen shot showing the Viewer Pane after using the dplyr-plyr code in reprex::reprex()" alt="Screen shot showing the Viewer Pane after using the dplyr-plyr code in reprex::reprex()" width="100%" /&gt;
]

---

class: with-logo logo-reprex

### Suppress startup messages

In this case at least one of the start-up messages is useful. However, often when asking for it is not useful to include the start-up messages and you'd want to suppress them.

.pull-left[
One option is to use `suppressPackageStartupMessages()` on chatty packages like **dplyr**.

.smaller[

```r
reprex::reprex({
    suppressPackageStartupMessages(library(dplyr))
    suppressPackageStartupMessages(library(plyr))
    
    mtcars %&gt;%
        group_by(cyl) %&gt;%
        summarise(mpg = mean(mpg))
})
```
]
]

.pull-right[
&lt;img src="figs/week09_files/reprex_dplyr2.png" title="Screen shot showing the Viewer Pane after using the dplyr-plyr code in reprex::reprex() while suppressing messages" alt="Screen shot showing the Viewer Pane after using the dplyr-plyr code in reprex::reprex() while suppressing messages" width="100%" /&gt;

&lt;br/&gt;
Note the output from the code is commented out. This allows someone else to copy the entire chunk of example code, including any output, and run it without trouble.
]

---

class: with-logo logo-reprex

### Suppress startup messages

Another option is to use a special comment that work like Rmd chunks, `#+`, to add **knitr** chunk options to suppress messages and warnings.

.pull-left[

```r
reprex::reprex({
    #+ message = FALSE, warning = FALSE
    library(dplyr)
    library(plyr)
    
    mtcars %&gt;%
        group_by(cyl) %&gt;%
        summarise(mpg = mean(mpg))
})
```
]

.pull-right[
&lt;img src="figs/week09_files/reprex_dplyr3.png" title="Screen shot showing the Viewer Pane after using the dplyr-plyr code in reprex::reprex() while suppressing messages with #+ chunks" alt="Screen shot showing the Viewer Pane after using the dplyr-plyr code in reprex::reprex() while suppressing messages with #+ chunks" width="100%" /&gt;
]

.footnote[
Read about these options and more in the [Suppress package startup messages article](https://reprex.tidyverse.org/articles/articles/suppress-startup-messages.html)
]

---

class: with-logo logo-reprex

### Adding your session info

In some instances, providing your *session info* is important. Session info includes information on your operating system, R version, and package versions.

Unfortunately the session info can get very long.  This can be distracting, and sometimes you will be explicitly asked *not* to provide it unless it is requested.

--

&lt;br/&gt;&lt;br/&gt;
**reprex** allows you to add your session info in a collapsible format on GitHub using the `session_info` argument. 

**Note:** Stack Overflow does not allow for collapsible sections at this time so the entirety of your session info will show there.

???

This is useful, as it allows you to provide your session info but it doesn't take up a ton of space.

---

class: with-logo logo-reprex

### Adding your session info

Add session info with `session_info = TRUE`.

.pull-left[


```r
reprex::reprex(session_info = TRUE, {
    #+ message = FALSE, warning = FALSE
    library(dplyr)
    library(plyr)
    
    mtcars %&gt;%
        group_by(cyl) %&gt;%
        summarise(mpg = mean(mpg))
})
```
]

.pull-right[
&lt;img src="figs/week09_files/reprex_session.png" title="Screen shot showing the Viewer Pane after using the dplyr-plyr code in reprex::reprex() with collapsed session info" alt="Screen shot showing the Viewer Pane after using the dplyr-plyr code in reprex::reprex() with collapsed session info" width="100%" /&gt;
]

---

class: with-logo logo-reprex

### Adding your session info

Here's what opening the session info arrow looks like.

.pull-left[
&lt;img src="figs/week09_files/reprex_session_long.png" title="Screen shot showing the Viewer Pane after using the dplyr-plyr code in reprex::reprex() with session info uncollapsed" alt="Screen shot showing the Viewer Pane after using the dplyr-plyr code in reprex::reprex() with session info uncollapsed" width="100%" /&gt;
]

--

.pull-right[
There's more you can do with **reprex** that we won't cover.

Refer to the package website at https://reprex.tidyverse.org/index.html for more info!
]

---

## Next week

- We'll discuss the process and etiquette for reporting issues on GitHub &lt;svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" class="rfa" style="height:0.75em;fill:currentColor;position:relative;"&gt;&lt;path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/&gt;&lt;/svg&gt; repositories 
- We will take the time to make a practice GitHub issue, using package **reprex** to add code and output 


.footnote[
[Code for slides](https://github.com/aosmith16/spring-r-topics/tree/main/docs/slides)  
Slides created via the R packages:  
[**xaringan**](https://github.com/yihui/xaringan), 
[gadenbuie/xaringanthemer](https://github.com/gadenbuie/xaringanthemer), 
[gadenbuie/xaringanExtra](https://github.com/gadenbuie/xaringanExtra) 
.center[*This work is licensed under the Creative Commons Attribution-NonCommercial 4.0 International License. 
To view a copy of this license, visit http://creativecommons.org/licenses/by-nc/4.0/.*]
]
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="https://platform.twitter.com/widgets.js"></script>
<script>var slideshow = remark.create({
"slideNumberFormat": "%current%",
"highlightStyle": "github",
"highlightLines": true,
"ratio": "16:9",
"countIncrementalSlides": true
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
